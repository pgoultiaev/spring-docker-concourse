---
resources:
- name: spring-gitrepo
  type: git
  check_every: 10s
  source:
    uri: https://github.com/pgoultiaev/spring-docker-concourse.git

jobs:
- name: build-and-test
  public: true
  plan:
  - get: spring-gitrepo
    trigger: true
  - task: unit-test
    file: spring-gitrepo/concourse/tasks/unit-test.yml
  - task: build
    file: spring-gitrepo/concourse/tasks/build.yml

- name: build-gradle
    plan:
      - get: spring-gitrepo
        trigger: true
      - task: build
        config:
          platform: linux
          image_resource:
            type: docker-image
            source:
                repository: gradle
                tag: '5.3-alpine'
          inputs:
            - name: spring-gitrepo
          run:
            dir: spring-gitrepo
            path: gradle
            user: root
            args:
              - build
